{"ast":null,"code":"var _jsxFileName = \"/Users/matthewvolny/Desktop/DigitalCrafts/Displayed-Projects/Crypto-App/src/components/Chart.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState, useEffect, useRef } from \"react\";\nimport ChartControls from \"./ChartControls\";\nimport Context from \"../context/context\";\nimport { createChart } from \"lightweight-charts\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport \"./chart.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nmoment().format();\nexport default function Chart() {\n  _s();\n\n  const {\n    selectedCoinData\n  } = useContext(Context);\n  const [coinChartData, setCoinChartData] = useState(); //!set viewfield duration back to 1\n\n  const [viewFieldDuration, setViewFieldDuration] = useState(\"1\");\n  const [timeFrameToFetch, setTimeFrameToFetch] = useState(\"90\");\n  const isMounted = useRef(false); //const isMountedTwo = useRef(false);\n\n  const prevTimeFrameToFetchRef = useRef(\"90\"); //const prevViewFieldDurationRef = useRef();\n  //global variables\n\n  const {\n    rank,\n    image,\n    name,\n    symbol,\n    price,\n    percentChange24hr,\n    percentChange7d,\n    marketCap,\n    volume24hr\n  } = selectedCoinData;\n  const coinId = selectedCoinData.id;\n  let globalChart;\n  let globalLineSeries;\n  let globalVolumeSeries; //(2)retrieves price/volume data for for varying periods of time\n\n  const retrieveChartData = duration => {\n    const coinLowercase = coinId.charAt(0).toLowerCase() + coinId.slice(1);\n    axios.get(`https://api.coingecko.com/api/v3/coins/${coinLowercase}/market_chart?vs_currency=usd&days=${duration}`).then(response => {\n      const data = response.data;\n      console.log(\"fetched data\");\n      console.log(data); //formats \"price\" data based on whether it is in \"days\" or \"hrs\"\n\n      const priceData = data.prices;\n      const priceDataArray = [];\n\n      if (duration === \"max\") {\n        //if viewfield set to \"max\"\n        console.log(`data in \"week\" format`);\n\n        for (let i = priceData.length - 1; i >= 0; i--) {\n          if (i % 7 === 0) {\n            priceDataArray.unshift({\n              time: moment(priceData[i][0]).format(\"MM/DD/YYYY\"),\n              value: priceData[i][1].toFixed(4)\n            });\n          }\n        }\n      } else if (duration === \"1095\") {\n        //if viewfield set to \"365\"\n        console.log(`data in \"day\" format`);\n        priceData.forEach(priceArray => {\n          priceDataArray.push({\n            time: moment(priceArray[0]).format(\"MM/DD/YYYY\"),\n            value: priceArray[1].toFixed(4)\n          });\n        });\n      } else {\n        // console.log(`price in \"hr\" format`);\n        priceData.forEach(priceArray => {\n          const unixDate = Math.floor(priceArray[0] / 1000);\n          const unixDateTZAdjusted = unixDate - 14400;\n          priceDataArray.push({\n            time: unixDateTZAdjusted,\n            value: priceArray[1].toFixed(4)\n          });\n        });\n      } //formats \"volume\" data based on whether it is in \"days\" or \"hrs\"\n\n\n      const volumeData = data.total_volumes;\n      const volumeDataArray = [];\n\n      if (duration === \"max\") {\n        //if viewfield set to \"max\"\n        console.log(`data in \"week\" format`);\n\n        for (let i = volumeData.length - 1; i >= 0; i--) {\n          if (i % 7 === 0) {\n            volumeDataArray.unshift({\n              time: moment(volumeData[i][0]).format(\"MM/DD/YYYY\"),\n              value: volumeData[i][1].toFixed(4)\n            });\n          }\n        }\n      } else if (duration === \"1095\") {\n        //if viewfield set to \"365\"\n        console.log(`data in \"day\" format`);\n        volumeData.forEach(volumeArray => {\n          volumeDataArray.push({\n            time: moment(volumeArray[0]).format(\"MM/DD/YYYY\"),\n            value: volumeArray[1].toFixed(4)\n          });\n        });\n      } else {\n        // console.log(`volume in \"hr\" format`);\n        volumeData.forEach(volumeArray => {\n          const unixDate = Math.floor(volumeArray[0] / 1000);\n          const unixDateTZAdjusted = unixDate - 14400;\n          volumeDataArray.push({\n            time: unixDateTZAdjusted,\n            value: volumeArray[1].toFixed(4)\n          });\n        });\n      }\n\n      setCoinChartData({\n        prices: priceDataArray,\n        volume: volumeDataArray\n      });\n    });\n  }; //(1)calls function making API request for chart data, when  component rendered, coin selected, or \"timeframe\" for particular coin is changed (with button click)\n  //const isMounted = useRef(false);\n  //  if (isMounted.current) {\n  //     if (document.querySelector(\".tv-lightweight-charts\")) {\n  //       updateChartData(coinChartData);\n  //     } else {\n  //       renderChart(coinChartData);\n  //     }\n  //   } else {\n  //     isMounted.current = true;\n  //   }\n\n\n  useEffect(() => {\n    console.log(\"number 1\");\n    prevTimeFrameToFetchRef.current = timeFrameToFetch; //!can limit redundant calls here(i.e. repeated 30day calls)\n\n    retrieveChartData(timeFrameToFetch);\n  }, [selectedCoinData]); //(4a)renders the chart\n\n  const renderChart = coinChartData => {\n    console.log(coinChartData);\n    const chart = createChart(document.querySelector(\".chart\"), {\n      width: 500,\n      height: 400,\n      rightPriceScale: {\n        visible: true\n      },\n      grid: {\n        vertLines: {\n          visible: true\n        },\n        horzLines: {\n          visible: true\n        }\n      },\n      crosshair: {\n        vertLine: {\n          visible: true\n        },\n        horzLine: {\n          visible: true\n        }\n      },\n      layout: {\n        backgroundColor: \"white\"\n      },\n      timeScale: {\n        timeVisible: true,\n        secondsVisible: true\n      } // localization: {\n      //   timeFormatter: (businessDayOrTimestamp) => {\n      //     if (chart.isBusinessDay(businessDayOrTimestamp)) {\n      //       return (\n      //         \"bd=\" +\n      //         businessDayOrTimestamp.day +\n      //         \"-\" +\n      //         businessDayOrTimestamp.month +\n      //         \"-\" +\n      //         businessDayOrTimestamp.year\n      //       );\n      //     }\n      //     return \"ts=\" + businessDayOrTimestamp;\n      //   },\n      // },\n\n    });\n    const lineSeries = chart.addLineSeries();\n    lineSeries.applyOptions({\n      color: \"red\",\n      lineWidth: 4,\n      crosshairMarkerVisible: true,\n      lastValueVisible: true,\n      priceLineVisible: true,\n      visible: true\n    }); // console.log(coinChartData.prices);\n\n    lineSeries.setData(coinChartData.prices);\n    const volumeSeries = chart.addHistogramSeries({\n      color: \"#26a69a\",\n      priceFormat: {\n        type: \"volume\"\n      },\n      priceScaleId: \"\",\n      scaleMargins: {\n        top: 0.8,\n        bottom: 0\n      }\n    }); // console.log(coinChartData.volume);\n\n    volumeSeries.setData(coinChartData.volume); // //!show values back to a given date\n\n    const todaysDate = new Date();\n    const todaysDateUnixTime = new Date(todaysDate).getTime() / 1000; // const todaysFormattedUnixDate = Math.floor(todaysDate / 1000);\n\n    switch (viewFieldDuration) {\n      case \"1\":\n        console.log(\"case 1\");\n        const twentyFourHoursPriorDate = todaysDateUnixTime - 86400; //!alternatively can show beginning of actual day (though this is more relevant for stocks, not crypto)\n        // todaysDate.setUTCHours(0, 0, 0, 0);\n        // const beginningOfDay = todaysDate.toUTCString();\n        // const beginningOfDayUnixTime =\n        //   new Date(beginningOfDay).getTime() / 1000;\n\n        chart.timeScale().setVisibleRange({\n          from: twentyFourHoursPriorDate,\n          to: todaysDateUnixTime\n        });\n        break;\n\n      case \"7\":\n        console.log(\"case 7\");\n        const sevenDaysPriorDate = todaysDateUnixTime - 604800;\n        chart.timeScale().setVisibleRange({\n          from: sevenDaysPriorDate,\n          to: todaysDateUnixTime\n        });\n        break;\n\n      case \"30\":\n        console.log(\"case 30\");\n        const oneMonthPriorDate = todaysDateUnixTime - 2592000;\n        chart.timeScale().setVisibleRange({\n          from: oneMonthPriorDate,\n          to: todaysDateUnixTime\n        });\n        break;\n\n      case \"365\":\n        console.log(\"case 365\"); // debugger;\n\n        const oneYearPriorDate = todaysDateUnixTime - 3.154e7;\n        chart.timeScale().setVisibleRange({\n          from: oneYearPriorDate,\n          to: todaysDateUnixTime\n        });\n        break;\n\n      case \"1095\":\n        console.log(\"case 1095\");\n        const threeYearsPriorDate = todaysDateUnixTime - 9.467e7;\n        chart.timeScale().setVisibleRange({\n          from: threeYearsPriorDate,\n          to: todaysDateUnixTime\n        });\n        break;\n\n      case \"max\":\n        console.log(\"case max\");\n        chart.timeScale().fitContent();\n        break;\n\n      default: // code block\n\n    } //global variables used to update the chart (not currently being used)\n\n\n    globalChart = chart;\n    globalLineSeries = lineSeries;\n    globalVolumeSeries = volumeSeries;\n  }; //(4b)change chart data(two methods)\n\n\n  const updateChartData = newData => {\n    console.log(\"updateChart\");\n    console.log(newData); //!two approaches to replacing data in chart\n    //!(1)-delete chart\n\n    const previousChart = document.querySelector(\".tv-lightweight-charts\");\n    previousChart.remove();\n    renderChart(newData); // //!(2)-delete series (presumably faster(?), not sure)\n    // globalChart.removeSeries(globalLineSeries);\n    // const newLineSeries = globalChart.addLineSeries();\n    // newLineSeries.applyOptions({\n    //   color: \"red\",\n    //   lineWidth: 4,\n    //   crosshairMarkerVisible: true,\n    //   //!may or may not keep these two on\n    //   lastValueVisible: true,\n    //   priceLineVisible: true,\n    // });\n    // newLineSeries.setData(newData);\n    // //!very usefull, keeps all data in frame\n    // // globalChart.timeScale().fitContent();\n    // //!scrolls screen 5 days to the left (with or without animation) - may have limited utility, as moves right side as well\n    // //globalChart.timeScale().scrollToPosition(-5, true);\n    // //!show values back to a given date\n    // globalChart.timeScale().setVisibleRange({\n    //   //!can programmatically get various times in the past(1yr ago,  max, etc.) from: new Date(new Date().setFullYear(new Date().getFullYear() - 1)),\n    //   from: \"2018-12-17\",\n    //   //!most recent date (may be able to set this a little in the future to get more space)\n    //   to: new Date().toISOString().slice(0, 10),\n    //   //or this // to: Date.now() / 1000;\n    // });\n  }; //(3)renders a new chart or updates the current chart with new data (* this is (1) if chart is already rendered, as it updates chart on button click)\n\n\n  useEffect(() => {\n    if (isMounted.current) {\n      if (document.querySelector(\".tv-lightweight-charts\")) {\n        //!if user has clicked a different timeframe to fetch (i.e. from 90 days to max)\n        if (prevTimeFrameToFetchRef.current !== timeFrameToFetch) {\n          console.log(\"retrieve chart data - new timeframe\");\n          retrieveChartData(timeFrameToFetch);\n          prevTimeFrameToFetchRef.current = timeFrameToFetch;\n        } else {\n          console.log(\"updateChartData - same timeframe\"); //! issue is here, when you click 365 before all it is the same timeframe and cannot add weekly data to state\n          //deletes the chart before rendering\n\n          updateChartData(coinChartData);\n        }\n      } else {\n        renderChart(coinChartData);\n      }\n    } else {\n      isMounted.current = true;\n    }\n  }, [coinChartData, viewFieldDuration]); // const fetchCoinDescription = (id) => {\n  //   axios\n  //     .get(`https://api.coingecko.com/api/v3/coins/${id}`)\n  //     .then((response) => {\n  //       const data = response.data;\n  //       console.log(data);\n  //       console.log(data.description.en);\n  //       const selectedCoinData = selectedCoinData;\n  //       selectedCoinData.description = data.description.en;\n  //       // console.log(coinDataArray);\n  //       // setCoinData(coinDataArray);\n  //     });\n  // };\n  // // useEffect(() => {\n  // //   fetchCoinDescription(id);\n  // // }, []);\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"coin-details-flex\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"icon\",\n        src: image,\n        alt: \"icon\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: symbol\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: rank\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"$\", price]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [percentChange24hr, \"%\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: marketCap\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: volume24hr\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-with-controls-container\",\n      children: [/*#__PURE__*/_jsxDEV(ChartControls, {\n        setViewFieldDuration: setViewFieldDuration,\n        setTimeFrameToFetch: setTimeFrameToFetch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 379,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Chart, \"fDR4XrvE07sAyyYcD2JwAbhzlVM=\");\n\n_c = Chart;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chart\");","map":{"version":3,"sources":["/Users/matthewvolny/Desktop/DigitalCrafts/Displayed-Projects/Crypto-App/src/components/Chart.js"],"names":["React","useContext","useState","useEffect","useRef","ChartControls","Context","createChart","axios","moment","format","Chart","selectedCoinData","coinChartData","setCoinChartData","viewFieldDuration","setViewFieldDuration","timeFrameToFetch","setTimeFrameToFetch","isMounted","prevTimeFrameToFetchRef","rank","image","name","symbol","price","percentChange24hr","percentChange7d","marketCap","volume24hr","coinId","id","globalChart","globalLineSeries","globalVolumeSeries","retrieveChartData","duration","coinLowercase","charAt","toLowerCase","slice","get","then","response","data","console","log","priceData","prices","priceDataArray","i","length","unshift","time","value","toFixed","forEach","priceArray","push","unixDate","Math","floor","unixDateTZAdjusted","volumeData","total_volumes","volumeDataArray","volumeArray","volume","current","renderChart","chart","document","querySelector","width","height","rightPriceScale","visible","grid","vertLines","horzLines","crosshair","vertLine","horzLine","layout","backgroundColor","timeScale","timeVisible","secondsVisible","lineSeries","addLineSeries","applyOptions","color","lineWidth","crosshairMarkerVisible","lastValueVisible","priceLineVisible","setData","volumeSeries","addHistogramSeries","priceFormat","type","priceScaleId","scaleMargins","top","bottom","todaysDate","Date","todaysDateUnixTime","getTime","twentyFourHoursPriorDate","setVisibleRange","from","to","sevenDaysPriorDate","oneMonthPriorDate","oneYearPriorDate","threeYearsPriorDate","fitContent","updateChartData","newData","previousChart","remove"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, useRef } from \"react\";\nimport ChartControls from \"./ChartControls\";\nimport Context from \"../context/context\";\nimport { createChart } from \"lightweight-charts\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport \"./chart.css\";\nmoment().format();\n\nexport default function Chart() {\n  const { selectedCoinData } = useContext(Context);\n  const [coinChartData, setCoinChartData] = useState();\n  //!set viewfield duration back to 1\n  const [viewFieldDuration, setViewFieldDuration] = useState(\"1\");\n  const [timeFrameToFetch, setTimeFrameToFetch] = useState(\"90\");\n  const isMounted = useRef(false);\n  //const isMountedTwo = useRef(false);\n  const prevTimeFrameToFetchRef = useRef(\"90\");\n  //const prevViewFieldDurationRef = useRef();\n\n  //global variables\n  const {\n    rank,\n    image,\n    name,\n    symbol,\n    price,\n    percentChange24hr,\n    percentChange7d,\n    marketCap,\n    volume24hr,\n  } = selectedCoinData;\n\n  const coinId = selectedCoinData.id;\n  let globalChart;\n  let globalLineSeries;\n  let globalVolumeSeries;\n\n  //(2)retrieves price/volume data for for varying periods of time\n  const retrieveChartData = (duration) => {\n    const coinLowercase = coinId.charAt(0).toLowerCase() + coinId.slice(1);\n    axios\n      .get(\n        `https://api.coingecko.com/api/v3/coins/${coinLowercase}/market_chart?vs_currency=usd&days=${duration}`\n      )\n      .then((response) => {\n        const data = response.data;\n        console.log(\"fetched data\");\n        console.log(data);\n        //formats \"price\" data based on whether it is in \"days\" or \"hrs\"\n        const priceData = data.prices;\n        const priceDataArray = [];\n        if (duration === \"max\") {\n          //if viewfield set to \"max\"\n          console.log(`data in \"week\" format`);\n          for (let i = priceData.length - 1; i >= 0; i--) {\n            if (i % 7 === 0) {\n              priceDataArray.unshift({\n                time: moment(priceData[i][0]).format(\"MM/DD/YYYY\"),\n                value: priceData[i][1].toFixed(4),\n              });\n            }\n          }\n        } else if (duration === \"1095\") {\n          //if viewfield set to \"365\"\n          console.log(`data in \"day\" format`);\n          priceData.forEach((priceArray) => {\n            priceDataArray.push({\n              time: moment(priceArray[0]).format(\"MM/DD/YYYY\"),\n              value: priceArray[1].toFixed(4),\n            });\n          });\n        } else {\n          // console.log(`price in \"hr\" format`);\n          priceData.forEach((priceArray) => {\n            const unixDate = Math.floor(priceArray[0] / 1000);\n            const unixDateTZAdjusted = unixDate - 14400;\n            priceDataArray.push({\n              time: unixDateTZAdjusted,\n              value: priceArray[1].toFixed(4),\n            });\n          });\n        }\n        //formats \"volume\" data based on whether it is in \"days\" or \"hrs\"\n        const volumeData = data.total_volumes;\n        const volumeDataArray = [];\n        if (duration === \"max\") {\n          //if viewfield set to \"max\"\n          console.log(`data in \"week\" format`);\n          for (let i = volumeData.length - 1; i >= 0; i--) {\n            if (i % 7 === 0) {\n              volumeDataArray.unshift({\n                time: moment(volumeData[i][0]).format(\"MM/DD/YYYY\"),\n                value: volumeData[i][1].toFixed(4),\n              });\n            }\n          }\n        } else if (duration === \"1095\") {\n          //if viewfield set to \"365\"\n          console.log(`data in \"day\" format`);\n          volumeData.forEach((volumeArray) => {\n            volumeDataArray.push({\n              time: moment(volumeArray[0]).format(\"MM/DD/YYYY\"),\n              value: volumeArray[1].toFixed(4),\n            });\n          });\n        } else {\n          // console.log(`volume in \"hr\" format`);\n          volumeData.forEach((volumeArray) => {\n            const unixDate = Math.floor(volumeArray[0] / 1000);\n            const unixDateTZAdjusted = unixDate - 14400;\n            volumeDataArray.push({\n              time: unixDateTZAdjusted,\n              value: volumeArray[1].toFixed(4),\n            });\n          });\n        }\n        setCoinChartData({ prices: priceDataArray, volume: volumeDataArray });\n      });\n  };\n\n  //(1)calls function making API request for chart data, when  component rendered, coin selected, or \"timeframe\" for particular coin is changed (with button click)\n\n  //const isMounted = useRef(false);\n\n  //  if (isMounted.current) {\n  //     if (document.querySelector(\".tv-lightweight-charts\")) {\n  //       updateChartData(coinChartData);\n  //     } else {\n  //       renderChart(coinChartData);\n  //     }\n  //   } else {\n  //     isMounted.current = true;\n  //   }\n\n  useEffect(() => {\n    console.log(\"number 1\");\n    prevTimeFrameToFetchRef.current = timeFrameToFetch;\n    //!can limit redundant calls here(i.e. repeated 30day calls)\n    retrieveChartData(timeFrameToFetch);\n  }, [selectedCoinData]);\n\n  //(4a)renders the chart\n  const renderChart = (coinChartData) => {\n    console.log(coinChartData);\n    const chart = createChart(document.querySelector(\".chart\"), {\n      width: 500,\n      height: 400,\n      rightPriceScale: {\n        visible: true,\n      },\n      grid: {\n        vertLines: {\n          visible: true,\n        },\n        horzLines: {\n          visible: true,\n        },\n      },\n      crosshair: {\n        vertLine: {\n          visible: true,\n        },\n        horzLine: {\n          visible: true,\n        },\n      },\n      layout: {\n        backgroundColor: \"white\",\n      },\n      timeScale: {\n        timeVisible: true,\n        secondsVisible: true,\n      },\n      // localization: {\n      //   timeFormatter: (businessDayOrTimestamp) => {\n      //     if (chart.isBusinessDay(businessDayOrTimestamp)) {\n      //       return (\n      //         \"bd=\" +\n      //         businessDayOrTimestamp.day +\n      //         \"-\" +\n      //         businessDayOrTimestamp.month +\n      //         \"-\" +\n      //         businessDayOrTimestamp.year\n      //       );\n      //     }\n\n      //     return \"ts=\" + businessDayOrTimestamp;\n      //   },\n      // },\n    });\n    const lineSeries = chart.addLineSeries();\n    lineSeries.applyOptions({\n      color: \"red\",\n      lineWidth: 4,\n      crosshairMarkerVisible: true,\n      lastValueVisible: true,\n      priceLineVisible: true,\n      visible: true,\n    });\n    // console.log(coinChartData.prices);\n    lineSeries.setData(coinChartData.prices);\n\n    const volumeSeries = chart.addHistogramSeries({\n      color: \"#26a69a\",\n      priceFormat: {\n        type: \"volume\",\n      },\n      priceScaleId: \"\",\n      scaleMargins: {\n        top: 0.8,\n        bottom: 0,\n      },\n    });\n    // console.log(coinChartData.volume);\n    volumeSeries.setData(coinChartData.volume);\n\n    // //!show values back to a given date\n    const todaysDate = new Date();\n    const todaysDateUnixTime = new Date(todaysDate).getTime() / 1000;\n    // const todaysFormattedUnixDate = Math.floor(todaysDate / 1000);\n    switch (viewFieldDuration) {\n      case \"1\":\n        console.log(\"case 1\");\n        const twentyFourHoursPriorDate = todaysDateUnixTime - 86400;\n        //!alternatively can show beginning of actual day (though this is more relevant for stocks, not crypto)\n        // todaysDate.setUTCHours(0, 0, 0, 0);\n        // const beginningOfDay = todaysDate.toUTCString();\n        // const beginningOfDayUnixTime =\n        //   new Date(beginningOfDay).getTime() / 1000;\n        chart.timeScale().setVisibleRange({\n          from: twentyFourHoursPriorDate,\n          to: todaysDateUnixTime,\n        });\n        break;\n      case \"7\":\n        console.log(\"case 7\");\n        const sevenDaysPriorDate = todaysDateUnixTime - 604800;\n        chart.timeScale().setVisibleRange({\n          from: sevenDaysPriorDate,\n          to: todaysDateUnixTime,\n        });\n        break;\n      case \"30\":\n        console.log(\"case 30\");\n        const oneMonthPriorDate = todaysDateUnixTime - 2592000;\n        chart.timeScale().setVisibleRange({\n          from: oneMonthPriorDate,\n          to: todaysDateUnixTime,\n        });\n        break;\n      case \"365\":\n        console.log(\"case 365\");\n        // debugger;\n        const oneYearPriorDate = todaysDateUnixTime - 3.154e7;\n        chart.timeScale().setVisibleRange({\n          from: oneYearPriorDate,\n          to: todaysDateUnixTime,\n        });\n        break;\n      case \"1095\":\n        console.log(\"case 1095\");\n        const threeYearsPriorDate = todaysDateUnixTime - 9.467e7;\n        chart.timeScale().setVisibleRange({\n          from: threeYearsPriorDate,\n          to: todaysDateUnixTime,\n        });\n        break;\n      case \"max\":\n        console.log(\"case max\");\n        chart.timeScale().fitContent();\n        break;\n      default:\n      // code block\n    }\n    //global variables used to update the chart (not currently being used)\n    globalChart = chart;\n    globalLineSeries = lineSeries;\n    globalVolumeSeries = volumeSeries;\n  };\n\n  //(4b)change chart data(two methods)\n  const updateChartData = (newData) => {\n    console.log(\"updateChart\");\n    console.log(newData);\n    //!two approaches to replacing data in chart\n    //!(1)-delete chart\n    const previousChart = document.querySelector(\".tv-lightweight-charts\");\n    previousChart.remove();\n    renderChart(newData);\n\n    // //!(2)-delete series (presumably faster(?), not sure)\n    // globalChart.removeSeries(globalLineSeries);\n    // const newLineSeries = globalChart.addLineSeries();\n    // newLineSeries.applyOptions({\n    //   color: \"red\",\n    //   lineWidth: 4,\n    //   crosshairMarkerVisible: true,\n    //   //!may or may not keep these two on\n    //   lastValueVisible: true,\n    //   priceLineVisible: true,\n    // });\n    // newLineSeries.setData(newData);\n\n    // //!very usefull, keeps all data in frame\n    // // globalChart.timeScale().fitContent();\n\n    // //!scrolls screen 5 days to the left (with or without animation) - may have limited utility, as moves right side as well\n    // //globalChart.timeScale().scrollToPosition(-5, true);\n    // //!show values back to a given date\n    // globalChart.timeScale().setVisibleRange({\n    //   //!can programmatically get various times in the past(1yr ago,  max, etc.) from: new Date(new Date().setFullYear(new Date().getFullYear() - 1)),\n    //   from: \"2018-12-17\",\n    //   //!most recent date (may be able to set this a little in the future to get more space)\n    //   to: new Date().toISOString().slice(0, 10),\n    //   //or this // to: Date.now() / 1000;\n    // });\n  };\n\n  //(3)renders a new chart or updates the current chart with new data (* this is (1) if chart is already rendered, as it updates chart on button click)\n  useEffect(() => {\n    if (isMounted.current) {\n      if (document.querySelector(\".tv-lightweight-charts\")) {\n        //!if user has clicked a different timeframe to fetch (i.e. from 90 days to max)\n        if (prevTimeFrameToFetchRef.current !== timeFrameToFetch) {\n          console.log(\"retrieve chart data - new timeframe\");\n          retrieveChartData(timeFrameToFetch);\n          prevTimeFrameToFetchRef.current = timeFrameToFetch;\n        } else {\n          console.log(\"updateChartData - same timeframe\");\n          //! issue is here, when you click 365 before all it is the same timeframe and cannot add weekly data to state\n          //deletes the chart before rendering\n          updateChartData(coinChartData);\n        }\n      } else {\n        renderChart(coinChartData);\n      }\n    } else {\n      isMounted.current = true;\n    }\n  }, [coinChartData, viewFieldDuration]);\n\n  // const fetchCoinDescription = (id) => {\n  //   axios\n  //     .get(`https://api.coingecko.com/api/v3/coins/${id}`)\n  //     .then((response) => {\n  //       const data = response.data;\n  //       console.log(data);\n  //       console.log(data.description.en);\n  //       const selectedCoinData = selectedCoinData;\n  //       selectedCoinData.description = data.description.en;\n\n  //       // console.log(coinDataArray);\n  //       // setCoinData(coinDataArray);\n  //     });\n  // };\n\n  // // useEffect(() => {\n  // //   fetchCoinDescription(id);\n  // // }, []);\n\n  return (\n    <>\n      <div className=\"coin-details-flex\">\n        <img className=\"icon\" src={image} alt=\"icon\" />\n        <div>{name}</div>\n        <div>{symbol}</div>\n        <div>{rank}</div>\n        <div>${price}</div>\n        <div>{percentChange24hr}%</div>\n        <div>{marketCap}</div>\n        <div>{volume24hr}</div>\n      </div>\n      <div className=\"chart-with-controls-container\">\n        <ChartControls\n          setViewFieldDuration={setViewFieldDuration}\n          setTimeFrameToFetch={setTimeFrameToFetch}\n        />\n        <div className=\"chart\"></div>\n      </div>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}